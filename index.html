<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proc√©dure de Consignation</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js" 
            integrity="sha256-REkB6vjQg19wb0q8oiGf/l9N2pJ1DeqPHp6JDrWKR7k=" 
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" 
            integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìã Proc√©dure de Consignation</h1>
            <p class="subtitle">Documentation de s√©curit√© pour intervention</p>
        </header>

        <!-- Informations sur l'intervention -->
        <section class="card info-section">
            <h2>üìù Informations sur l'intervention</h2>
            <div class="form-grid">
                <div class="form-group full-width">
                    <label for="titre">Titre :</label>
                    <input type="text" id="titre" class="form-control" placeholder="Titre de l'intervention">
                </div>
                <div class="form-group full-width">
                    <label for="description">Description :</label>
                    <textarea id="description" class="form-control" rows="3" placeholder="Description d√©taill√©e de l'intervention"></textarea>
                </div>
                <div class="form-group">
                    <label for="date">Date :</label>
                    <input type="date" id="date" class="form-control">
                </div>
                <div class="form-group">
                    <label for="numero">Num√©ro :</label>
                    <input type="text" id="numero" class="form-control" placeholder="N¬∞ d'intervention">
                </div>
                <div class="form-group">
                    <label for="personnel">Personnel :</label>
                    <input type="text" id="personnel" class="form-control" placeholder="Nom du personnel">
                </div>
                <div class="form-group">
                    <label for="localisation">Localisation :</label>
                    <input type="text" id="localisation" class="form-control" placeholder="Lieu d'intervention">
                </div>
                <div class="form-group full-width">
                    <label for="epi-epc">EPI/EPC requis :</label>
                    <div class="epi-epc-input-container">
                        <input type="text" id="epi-epc-input" class="form-control" placeholder="Commencer √† taper pour voir les suggestions..." autocomplete="off">
                        <div id="epi-epc-suggestions" class="suggestions-dropdown"></div>
                    </div>
                    <div id="epi-epc-list" class="epi-epc-list"></div>
                </div>
            </div>
        </section>

        <!-- Avertissement -->
        <section class="card warning-section">
            <h2>‚ö†Ô∏è Avertissements</h2>
            <div class="warning-content">
                <div class="danger-box">
                    <h3>üö® Danger</h3>
                    <div class="danger-input-container">
                        <input type="text" id="danger-input" class="form-control" placeholder="Commencer √† taper pour voir les dangers..." autocomplete="off">
                        <div id="danger-suggestions" class="suggestions-dropdown"></div>
                    </div>
                    <div id="danger-list" class="danger-list"></div>
                    <div id="danger-preview" class="markdown-preview"></div>
                </div>
                <div class="risk-box">
                    <h3>üîç Analyse de risques</h3>
                    <textarea id="analyse-risques" class="form-control markdown-support" rows="10" placeholder="Analyse d√©taill√©e des risques...&#10;&#10;Exemple (markdown support√©):&#10;- **Risque √©lectrique**: N√©cessite consignation compl√®te&#10;- **Mesures pr√©ventives**:&#10;  - V√©rifier VAT avant intervention&#10;  - Porter EPI √©lectrique adapt√©&#10;  - Installer signalisation de s√©curit√©"></textarea>
                    <div id="analyse-risques-preview" class="markdown-preview"></div>
                </div>
            </div>
        </section>

        <!-- Mat√©riel n√©cessaire -->
        <section class="card material-section">
            <h2>üîß Mat√©riel n√©cessaire</h2>
            <div class="material-input-group">
                <input type="text" id="new-material-designation" class="form-control" placeholder="D√©signation">
                <input type="number" id="new-material-quantity" class="form-control" placeholder="Nombre" min="1" value="1">
                <input type="number" id="new-material-price" class="form-control" placeholder="Prix Unitaire HT (‚Ç¨)" min="0" step="0.01">
                <button id="add-material-btn" class="btn btn-primary">Ajouter</button>
            </div>
            <div id="material-list" class="material-table">
                <div class="material-table-header">
                    <div>D√©signation</div>
                    <div>Nombre</div>
                    <div>Prix Unitaire HT</div>
                    <div>Total HT</div>
                    <div>Actions</div>
                </div>
                <div id="material-table-body"></div>
                <div class="material-table-footer">
                    <div></div>
                    <div></div>
                    <div><strong>Total:</strong></div>
                    <div id="material-total"><strong>0,00 ‚Ç¨</strong></div>
                    <div></div>
                </div>
            </div>
        </section>

        <!-- Liste de R√©f√©rences -->
        <section class="card references-section">
            <h2>üìö Liste de R√©f√©rences</h2>
            <div class="reference-controls">
                <div class="reference-input-group">
                    <input type="text" id="new-reference-document" class="form-control" placeholder="Document">
                    <input type="text" id="new-reference-page" class="form-control" placeholder="Page">
                    <select id="new-reference-type" class="form-control">
                        <option value="">S√©lectionner le type...</option>
                        <option value="Instructions, notes, guides">Instructions, notes, guides</option>
                        <option value="Dossier technique">Dossier technique</option>
                        <option value="R√®glement int√©rieur">R√®glement int√©rieur</option>
                        <option value="Normes nationales">Normes nationales</option>
                        <option value="Normes internationales">Normes internationales</option>
                    </select>
                    <button id="add-reference-btn" class="btn btn-primary">Ajouter</button>
                </div>
                <button id="sort-references-btn" class="btn btn-secondary">üî§ Trier A-Z</button>
            </div>
            <div id="reference-list" class="reference-table">
                <div class="reference-table-header">
                    <div>Document</div>
                    <div>Page</div>
                    <div>Type</div>
                    <div>Actions</div>
                </div>
                <div id="reference-table-body"></div>
            </div>
        </section>

        <!-- Instructions de consignation -->
        <section class="card instructions-section">
            <h2>üìñ Instructions de consignation</h2>
            <div class="instructions-controls">
                <button id="add-step-btn" class="btn btn-primary">‚ûï Ajouter une √©tape</button>
            </div>
            <div class="instructions-table">
                <div class="table-header">
                    <div class="col-repere">Rep√®re</div>
                    <div class="col-instruction">Instruction</div>
                    <div class="col-photo">Photo</div>
                </div>
                <div id="instructions-body" class="table-body">
                    <!-- Les √©tapes seront ajout√©es dynamiquement -->
                </div>
            </div>
        </section>

        <!-- Pistes d'am√©lioration -->
        <section class="card improvement-section">
            <h2>üí° Pistes d'am√©lioration</h2>
            <div class="improvement-input-group">
                <input type="text" id="new-improvement" class="form-control" placeholder="Ajouter une suggestion...">
                <button id="add-improvement-btn" class="btn btn-primary">Ajouter</button>
            </div>
            <ul id="improvement-list" class="improvement-list"></ul>
        </section>

        <!-- Actions -->
        <div class="actions">
            <button id="save-btn" class="btn btn-success">üíæ Enregistrer</button>
            <button id="load-btn" class="btn btn-info">üìÇ Charger</button>
            <button id="print-btn" class="btn btn-secondary">üñ®Ô∏è Imprimer</button>
            <button id="clear-btn" class="btn btn-danger">üóëÔ∏è Effacer tout</button>
        </div>

        <footer>
            <p>Document de s√©curit√© - Proc√©dure de consignation</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
